---
title: "Практическая работа 003"
author: "IT-life1@yandex.ru"
format: 
  md:
    output-file: README.md
---

## Цель работы

1. Отработать навыки анализа реальных данных с помощью языка R  
2. Закрепить понимание структуры табличных данных и их взаимосвязей  
3. Научиться эффективно применять функции пакета `dplyr` (`select()`, `filter()`, `mutate()`, `arrange()`, `group_by()`) для решения практических задач

## Исходные данные

1. Операционная система: Windows 10 
2. Среда разработки: RStudio Desktop  
3. Версия R: 4.5.1  

## Задание

С использованием пакета `nycflights13` и инструментов `dplyr` провести анализ авиационных данных за 2013 год и ответить на серию аналитических вопросов.

## Ход работы

1. Выполнить установку пакета `nycflights13`.

2. Провести анализ встроенных в пакет `nycflights13` наборов данных с использованием языка R и ответить на вопросы:

   1. Сколько встроенных в пакет nycflights13 датафреймов?  
   2. Сколько строк в каждом датафрейме?  
   3. Сколько столбцов в каждом датафрейме?  
   4. Как просмотреть примерный вид датафрейма?  
   5. Сколько компаний-перевозчиков (carrier) учитывают эти наборы данных (представлено в наборах данных)?  
   6. Сколько рейсов принял аэропорт John F Kennedy Intl в мае?  
   7. Какой самый северный аэропорт?  
   8. Какой аэропорт самый высокогорный (находится выше всех над уровнем моря)?  
   9. Какие бортовые номера у самых старых самолетов?  
   10. Какая средняя температура воздуха была в сентябре в аэропорту John FKennedy Intl (в градусах Цельсия)?  
   11. Самолеты какой авиакомпании совершили больше всего вылетов в июне?  
   12. Самолеты какой авиакомпании задерживались чаще других в 2013 году?

3. Подготовить отчёт в соответствии с заданным шаблоном.


### Шаг 1

Установка пакета `nycflights13`:

![](./imgs/img1.png)


### Шаг 2

Подключим необходимые библиотеки

```{r}
library(nycflights13)
```

```{r}
library(dplyr)
```


#### Сколько встроенных в пакет nycflights13 датафреймов?

```{r}
data(package = "nycflights13")$results[, "Item"] %>% length()
```


#### Сколько строк в каждом датафрейме?


```{r}
sapply(list(flights, weather, planes, airports, airlines), nrow)
```


#### Сколько столбцов в каждом датафрейме?


```{r}
ncol(flights)
```

```{r}
ncol(weather)
```

```{r}
ncol(planes)
```

```{r}
ncol(airports)
```

```{r}
ncol(airlines)
```


#### Как просмотреть примерный вид датафрейма?

```{r}
flights %>% glimpse()
```

```{r}
weather %>% glimpse()
```

```{r}
planes %>% glimpse()
```

```{r}
airports %>% glimpse()
```

```{r}
airlines %>% glimpse()
```


#### Сколько компаний-перевозчиков (carrier) учитывают эти наборы данных (представлено в наборах данных)?

```{r}
airlines %>% select(carrier) %>% n_distinct()
```


#### Сколько рейсов принял аэропорт John F Kennedy Intl в мае?

```{r}
flights %>%
  filter(origin == "JFK", month == 5) %>%
  nrow()
```


#### Какой самый северный аэропорт?


```{r}
airports %>%
  filter(!is.na(lat)) %>%
  slice_max(lat, n = 1) %>%
  pull(name)
```


#### Какой аэропорт самый высокогорный (находится выше всех над уровнем моря)?


```{r}
airports %>%
  filter(!is.na(alt)) %>%
  slice_max(alt, n = 1) %>%
  pull(name)
```


#### Какие бортовые номера у самых старых самолетов?


```{r}
planes %>%
  filter(!is.na(year)) %>%
  arrange(year) %>%
  head(6) %>%
  select(tailnum) %>%
  knitr::kable(format = "markdown")
```


#### Какая средняя температура воздуха была в сентябре в аэропорту John F Kennedy Intl (в градусах Цельсия).


```{r}
weather %>%
  filter(origin == "JFK", month == 9) %>%
  summarise(avg_temp_F = mean(temp, na.rm = TRUE)) %>%
  mutate(avg_temp_C = (avg_temp_F - 32) * 5 / 9) %>%
  pull(avg_temp_C)
```

#### Самолеты какой авиакомпании совершили больше всего вылетов в июне?

```{r}
flights %>%
  filter(month == 6) %>%
  count(carrier, sort = TRUE) %>%
  left_join(airlines, by = "carrier") %>%
  slice(1) %>%
  pull(name)
```


#### Самолеты какой авиакомпании задерживались чаще других в 2013 году?


```{r}
flights %>%
  filter(arr_delay > 0, year == 2013) %>%
  count(carrier, sort = TRUE) %>%
  left_join(airlines, by = "carrier") %>%
  slice(1) %>%
  pull(name)
```


### Шаг 3

Отчёт подготовлен и оформлен в соответствии с требованиями. Все задачи выполнены с использованием современных практик анализа данных в R.

